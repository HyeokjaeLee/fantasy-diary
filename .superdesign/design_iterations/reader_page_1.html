<!doctype html>
<html lang="ko" class="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fantasy Diary — Reader</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { sans: ['Inter','ui-sans-serif','system-ui'] } } } }
  </script>
  <link rel="stylesheet" href="./fantasy_theme_1.css" />
  <style>
    /* Weather icon animations */
    .weather-icon { width: 24px; height: 24px; display: inline-block; color: currentColor; }
    .weather-icon .sun-core { fill: currentColor; opacity: 0.95; }
    .weather-icon .sun-rays { stroke: currentColor; stroke-width: 2; stroke-linecap: round; opacity: 0.9; transform-origin: 12px 12px; animation: spin 12s linear infinite; }
    @keyframes spin { from { transform: rotate(0turn); } to { transform: rotate(1turn); } }
    /* Optional extras for future states
    .weather-icon .cloud { fill: currentColor; opacity: .35; }
    .weather-icon .raindrop { fill: currentColor; opacity: .7; animation: drop 1.2s ease-in infinite; }
    @keyframes drop { 0% { transform: translateY(-2px); opacity: 0; } 30% { opacity: 1; } 100% { transform: translateY(6px); opacity: 0; } }
    */
  </style>
</head>
<body class="min-h-screen antialiased">
  <!-- Header -->
  <header class="sticky top-0 z-20 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-black/40 border-b border-[color:var(--border)]">
    <div class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between">
      <button id="backBtn" class="btn btn-ghost flex items-center gap-2" aria-label="뒤로가기">
        <i data-lucide="arrow-left" class="w-4 h-4"></i>
        <span class="hidden sm:inline">뒤로</span>
      </button>
      <div class="flex items-center gap-2">
        <button id="themeToggle" class="btn btn-ghost flex items-center gap-2" aria-label="테마 토글">
          <i data-lucide="sun" class="w-4 h-4"></i>
          <span class="hidden sm:inline">테마</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-4xl mx-auto px-4 py-8">
    <!-- MetaBar -->
    <section class="space-y-2 fade-in">
      <h1 class="text-2xl sm:text-3xl font-bold">#123 — 유성우의 밤</h1>
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 text-sm opacity-80">
        <div class="flex items-center gap-2">
          <svg viewBox="0 0 24 24" class="weather-icon" aria-hidden="true">
            <circle class="sun-core" cx="12" cy="12" r="5"></circle>
            <g class="sun-rays">
              <line x1="12" y1="1.5" x2="12" y2="4.5"/>
              <line x1="12" y1="19.5" x2="12" y2="22.5"/>
              <line x1="1.5" y1="12" x2="4.5" y2="12"/>
              <line x1="19.5" y1="12" x2="22.5" y2="12"/>
              <line x1="4.22" y1="4.22" x2="6.34" y2="6.34"/>
              <line x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
              <line x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
              <line x1="17.66" y1="6.34" x2="19.78" y2="4.22"/>
            </g>
          </svg>
          <span>맑음</span>
        </div>
        <div>2025.08.27 · 21:05</div>
      </div>
    </section>

    <!-- Illustration -->
    <section class="mt-6 fade-in">
      <figure>
        <img src="https://images.unsplash.com/photo-1549880338-65ddcdfd017b?q=80&w=1600&auto=format&fit=crop" alt="챕터 삽화" class="w-full h-auto hero-cover" />
        <figcaption class="mt-2 text-xs opacity-70">삽화: 별이 쏟아지는 밤</figcaption>
      </figure>
    </section>

    <!-- Content -->
    <section class="mt-8 fade-in">
      <div id="reader" class="space-y-6 text-[18px] md:text-[19px] leading-[1.9]">
        <p>성문 너머로 별빛이 쏟아졌다. 잠들지 못한 밤, 서쪽의 하늘은 조용히 타오르고 있었다. 소년은 오래된 연대기의 빈 페이지를 펼쳐 들고, 잃어버린 한 줄을 찾아 나설 준비를 했다.</p>
        <p>그는 알고 있었다. 오늘의 선택이 그의 운명을, 그리고 왕국의 내일을 바꿀 것이라는 사실을. 바람은 낮게 노래했고, 검은 깃발은 하늘의 길을 가리켰다.</p>
        <p>그 순간, 멀리서 유성이 떨어졌다. 불꽃은 땅을 스치며 지나가 왕의 연대기 한가운데 새로운 흔적을 남겼다. 소년은 페이지를 덮고, 천천히 일어섰다.</p>
        <p>“서쪽으로.”</p>
      </div>
    </section>

    <!-- Controls -->
    <section class="mt-10 fade-in">
      <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3">
        <div class="flex items-center gap-2">
          <button id="fontDec" class="btn btn-ghost" aria-label="글자 크기 줄이기">A-</button>
          <button id="fontInc" class="btn btn-ghost" aria-label="글자 크기 키우기">A+</button>
          <button id="lineToggle" class="btn btn-ghost" aria-label="행간 토글">행간</button>
        </div>
        <div class="flex items-center gap-2">
          <a href="#prev" class="btn btn-ghost">이전</a>
          <a href="#next" class="btn btn-primary">다음</a>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer border-t border-[color:var(--border)] mt-10">
    <div class="max-w-4xl mx-auto px-4 py-8 text-sm flex flex-col sm:flex-row items-center justify-between gap-3">
      <div class="opacity-80">© 2025 Fantasy Diary</div>
      <nav class="flex items-center gap-4">
        <a href="./fantasy_home_1.html">홈</a>
        <a href="#">문의</a>
      </nav>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flowbite@2.0.0/dist/flowbite.min.js"></script>
  <script>
    // lucide icons
    window.lucide && window.lucide.createIcons();

    // theme toggle
    const themeBtn = document.getElementById('themeToggle');
    themeBtn?.addEventListener('click', () => {
      const html = document.documentElement;
      html.classList.toggle('dark');
      const icon = themeBtn.querySelector('[data-lucide]');
      if (icon) {
        const next = html.classList.contains('dark') ? 'sun' : 'moon';
        icon.setAttribute('data-lucide', next);
        window.lucide && window.lucide.createIcons();
      }
    });

    // back
    document.getElementById('backBtn')?.addEventListener('click', () => {
      if (history.length > 1) history.back();
      else window.location.href = './fantasy_home_1.html';
    });

    // reader controls
    const reader = document.getElementById('reader');
    const store = {
      get(key, fallback) { try { const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; } catch { return fallback } },
      set(key, val) { try { localStorage.setItem(key, JSON.stringify(val)); } catch {} }
    };

    const state = {
      font: store.get('reader:font', 18),
      line: store.get('reader:line', 1.9),
      clamp(min, val, max) { return Math.max(min, Math.min(val, max)); }
    };

    function apply() {
      if (!reader) return;
      reader.style.fontSize = state.font + 'px';
      reader.style.lineHeight = state.line.toString();
    }

    apply();

    document.getElementById('fontDec')?.addEventListener('click', () => {
      state.font = state.clamp(14, state.font - 1, 26);
      store.set('reader:font', state.font); apply();
    });
    document.getElementById('fontInc')?.addEventListener('click', () => {
      state.font = state.clamp(14, state.font + 1, 26);
      store.set('reader:font', state.font); apply();
    });
    document.getElementById('lineToggle')?.addEventListener('click', () => {
      state.line = state.line < 1.95 ? 2.0 : 1.8;
      store.set('reader:line', state.line); apply();
    });
  </script>
</body>
</html>
